(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["57cc4e98"],{"7a548065":function(e,a,t){t.d(a,"__esModule",{value:!0}),t.e(a,{default:function(){return I;}});var l=t("777fffbe"),n=t("852bbaa9"),u=t("f1317d59"),d=t("6aa21787"),s=l._(d),r=t("c4f784d0"),i=t("7f218433"),o=t("5f5abd30"),c=l._(o),m=t("560f8ccf"),f=l._(m),h=t("e4c810ea"),b=l._(h),x=t("ca346873"),p=l._(x),y=t("864c62b1"),_=n._(y),v=t("559eb373"),j=t("3ad4cd96"),k=t("f532449e"),g=l._(k),w=t("acb4a2ed"),C=l._(w);let M=({visible:e,onCancel:a,onSubmit:t,title:l,initialValues:n})=>{let d=!!n,s=(0,_.useMemo)(()=>n?{...n}:void 0,[n]);return(0,u.jsx)(b.default,{title:l,open:e,onCancel:a,footer:null,width:600,children:(0,u.jsxs)(j.ProForm,{initialValues:s,onFinish:async e=>{t(e);},submitter:{render:(e,t)=>[(0,u.jsx)(c.default,{onClick:a,children:"\u53D6\u6D88"},"cancel"),(0,u.jsx)(c.default,{type:"primary",onClick:()=>{var a,t;return null===(t=e.form)||void 0===t?void 0:null===(a=t.submit)||void 0===a?void 0:a.call(t);},children:"\u786E\u5B9A"},"submit")]},children:[!d&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(g.default,{name:"menu_code",label:"\u83DC\u5355\u7F16\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u83DC\u5355\u7F16\u7801"}]}),(0,u.jsx)(C.default,{name:"menu_type",label:"\u83DC\u5355\u7C7B\u578B",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u83DC\u5355\u7C7B\u578B"}],options:[{label:"\u76EE\u5F55",value:"M"},{label:"\u83DC\u5355",value:"C"},{label:"\u6309\u94AE",value:"F"}]})]}),d&&(0,u.jsx)(C.default,{name:"menu_type",label:"\u83DC\u5355\u7C7B\u578B",options:[{label:"\u76EE\u5F55",value:"M"},{label:"\u83DC\u5355",value:"C"},{label:"\u6309\u94AE",value:"F"}]}),(0,u.jsx)(g.default,{name:"parent_code",label:"\u7236\u83DC\u5355\u7F16\u7801"}),(0,u.jsx)(g.default,{name:"menu_name",label:"\u83DC\u5355\u540D\u79F0"}),(0,u.jsx)(g.default,{name:"perms",label:"\u6743\u9650\u6807\u8BC6"}),(0,u.jsx)(g.default,{name:"path",label:"\u8DEF\u5F84"}),(0,u.jsx)(g.default,{name:"component",label:"\u7EC4\u4EF6"}),(0,u.jsx)(C.default,{name:"status",label:"\u72B6\u6001",options:[{label:"\u542F\u7528",value:1},{label:"\u7981\u7528",value:0}]})]},d?null==n?void 0:n.menu_code:"create")});},I=()=>{let[e,a]=(0,_.useState)(!1),[t,l]=(0,_.useState)(!1),[n,d]=(0,_.useState)(null),o=(0,_.useRef)(),m=async e=>{try{let l=await (0,v.createMenu)(e);if(200===l.code){var t;f.default.success("\u521B\u5EFA\u6210\u529F"),a(!1),null===(t=o.current)||void 0===t||t.reload();}else f.default.error(l.message||"\u521B\u5EFA\u5931\u8D25");}catch(e){f.default.error("\u521B\u5EFA\u5931\u8D25");}},h=async e=>{if(n)try{let t=await (0,v.updateMenu)(n.menu_code,e);if(200===t.code){var a;f.default.success("\u66F4\u65B0\u6210\u529F"),l(!1),d(null),null===(a=o.current)||void 0===a||a.reload();}else f.default.error(t.message||"\u66F4\u65B0\u5931\u8D25");}catch(e){f.default.error("\u66F4\u65B0\u5931\u8D25");}},x=e=>{b.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:`\u{786E}\u{5B9A}\u{8981}\u{5220}\u{9664}\u{83DC}\u{5355} "${e.menu_name}" \u{5417}\u{FF1F}`,onOk:async()=>{try{let t=await (0,v.deleteMenu)(e.menu_code);if(200===t.code){var a;f.default.success("\u5220\u9664\u6210\u529F"),null===(a=o.current)||void 0===a||a.reload();}else f.default.error(t.message||"\u5220\u9664\u5931\u8D25");}catch(e){f.default.error("\u5220\u9664\u5931\u8D25");}}});},y=[{title:"\u83DC\u5355\u7F16\u7801",dataIndex:"menu_code",key:"menu_code",width:120},{title:"\u83DC\u5355\u540D\u79F0",dataIndex:"menu_name",key:"menu_name",width:150},{title:"\u83DC\u5355\u7C7B\u578B",dataIndex:"menu_type",key:"menu_type",width:100,valueEnum:{M:{text:"\u76EE\u5F55"},C:{text:"\u83DC\u5355"},F:{text:"\u6309\u94AE"}}},{title:"\u6743\u9650\u6807\u8BC6",dataIndex:"perms",key:"perms",width:150},{title:"\u8DEF\u5F84",dataIndex:"path",key:"path",width:200},{title:"\u7EC4\u4EF6",dataIndex:"component",key:"component",width:200},{title:"\u72B6\u6001",dataIndex:"status",key:"status",width:80,valueEnum:{1:{text:"\u542F\u7528",status:"Success"},0:{text:"\u7981\u7528",status:"Error"}}},{title:"\u64CD\u4F5C",key:"action",width:180,fixed:"right",render:(e,a)=>(0,u.jsxs)(p.default,{children:[(0,u.jsx)(c.default,{type:"link",size:"small",onClick:()=>{d(a),l(!0);},children:"\u7F16\u8F91"}),(0,u.jsx)(c.default,{type:"link",size:"small",danger:!0,onClick:()=>x(a),children:"\u5220\u9664"})]})}];return(0,u.jsxs)(r.PageContainer,{children:[(0,u.jsx)(i.ProTable,{headerTitle:"\u83DC\u5355\u7BA1\u7406",actionRef:o,rowKey:"menu_code",search:!1,toolBarRender:()=>[(0,u.jsxs)(c.default,{type:"primary",onClick:()=>{a(!0);},children:[(0,u.jsx)(s.default,{})," \u65B0\u5EFA"]},"primary")],request:async()=>{let e=await (0,v.getMenuTree)();if(200===e.code&&e.data){let a=e=>{let t=[];return e.forEach(e=>{t.push(e),e.children&&e.children.length>0&&t.push(...a(e.children));}),t;};return{data:a(e.data),success:!0,total:a(e.data).length};}return{data:[],success:!1,total:0};},columns:y,pagination:!1}),(0,u.jsx)(M,{visible:e,onCancel:()=>a(!1),onSubmit:m,title:"\u65B0\u5EFA\u83DC\u5355"}),n&&(0,u.jsx)(M,{visible:t,onCancel:()=>{l(!1),d(null);},onSubmit:h,title:"\u7F16\u8F91\u83DC\u5355",initialValues:n})]});};}}]);
//# sourceMappingURL=57cc4e98-async.dbf02b4b.js.map