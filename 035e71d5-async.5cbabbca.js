(("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]=("undefined"!=typeof globalThis?globalThis:self)["makoChunk_ant-design-pro"]||[]).push([["035e71d5"],{e7be08df:function(e,t,a){a.d(t,"__esModule",{value:!0}),a.e(t,{default:function(){return I;}});var l=a("777fffbe"),d=a("852bbaa9"),n=a("f1317d59"),s=a("6aa21787"),r=l._(s),i=a("c4f784d0"),u=a("7f218433"),c=a("5f5abd30"),o=l._(c),f=a("560f8ccf"),h=l._(f),m=a("e4c810ea"),p=l._(m),y=a("ca346873"),b=l._(y),_=a("864c62b1"),v=d._(_),x=a("9ee30b17");async function j(){return(0,x.request)("/api/v1/system/depts/tree",{method:"GET"});}async function g(e){return(0,x.request)("/api/v1/system/depts",{method:"POST",data:e});}async function k(e,t){return(0,x.request)(`/api/v1/system/depts/${e}`,{method:"PUT",data:t});}async function w(e){return(0,x.request)(`/api/v1/system/depts/${e}`,{method:"DELETE"});}var C=a("3ad4cd96"),T=a("f532449e"),q=l._(T),E=a("acb4a2ed"),S=l._(E);let P=({visible:e,onCancel:t,onSubmit:a,title:l,initialValues:d})=>{let s=!!d,r=(0,v.useMemo)(()=>d?{...d}:void 0,[d]);return(0,n.jsx)(p.default,{title:l,open:e,onCancel:t,footer:null,width:600,children:(0,n.jsxs)(C.ProForm,{initialValues:r,onFinish:async e=>{a(e);},submitter:{render:(e,a)=>[(0,n.jsx)(o.default,{onClick:t,children:"\u53D6\u6D88"},"cancel"),(0,n.jsx)(o.default,{type:"primary",onClick:()=>{var t,a;return null===(a=e.form)||void 0===a?void 0:null===(t=a.submit)||void 0===t?void 0:t.call(a);},children:"\u786E\u5B9A"},"submit")]},children:[!s&&(0,n.jsx)(q.default,{name:"dept_code",label:"\u90E8\u95E8\u7F16\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u7F16\u7801"}]}),(0,n.jsx)(q.default,{name:"parent_code",label:"\u7236\u90E8\u95E8\u7F16\u7801"}),!s&&(0,n.jsx)(q.default,{name:"dept_name",label:"\u90E8\u95E8\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0"}]}),s&&(0,n.jsx)(q.default,{name:"dept_name",label:"\u90E8\u95E8\u540D\u79F0"}),(0,n.jsx)(S.default,{name:"status",label:"\u72B6\u6001",options:[{label:"\u542F\u7528",value:1},{label:"\u7981\u7528",value:0}]})]},s?null==d?void 0:d.dept_code:"create")});},I=()=>{let[e,t]=(0,v.useState)(!1),[a,l]=(0,v.useState)(!1),[d,s]=(0,v.useState)(null),c=(0,v.useRef)(),f=async e=>{try{let l=await g(e);if(200===l.code){var a;h.default.success("\u521B\u5EFA\u6210\u529F"),t(!1),null===(a=c.current)||void 0===a||a.reload();}else h.default.error(l.message||"\u521B\u5EFA\u5931\u8D25");}catch(e){h.default.error("\u521B\u5EFA\u5931\u8D25");}},m=async e=>{if(d)try{let a=await k(d.dept_code,e);if(200===a.code){var t;h.default.success("\u66F4\u65B0\u6210\u529F"),l(!1),s(null),null===(t=c.current)||void 0===t||t.reload();}else h.default.error(a.message||"\u66F4\u65B0\u5931\u8D25");}catch(e){h.default.error("\u66F4\u65B0\u5931\u8D25");}},y=e=>{p.default.confirm({title:"\u786E\u8BA4\u5220\u9664",content:`\u{786E}\u{5B9A}\u{8981}\u{5220}\u{9664}\u{90E8}\u{95E8} "${e.dept_name}" \u{5417}\u{FF1F}`,onOk:async()=>{try{let a=await w(e.dept_code);if(200===a.code){var t;h.default.success("\u5220\u9664\u6210\u529F"),null===(t=c.current)||void 0===t||t.reload();}else h.default.error(a.message||"\u5220\u9664\u5931\u8D25");}catch(e){h.default.error("\u5220\u9664\u5931\u8D25");}}});},_=[{title:"\u90E8\u95E8\u7F16\u7801",dataIndex:"dept_code",key:"dept_code",width:120},{title:"\u90E8\u95E8\u540D\u79F0",dataIndex:"dept_name",key:"dept_name",width:200},{title:"\u7236\u90E8\u95E8\u7F16\u7801",dataIndex:"parent_code",key:"parent_code",width:120},{title:"\u72B6\u6001",dataIndex:"status",key:"status",width:80,valueEnum:{1:{text:"\u542F\u7528",status:"Success"},0:{text:"\u7981\u7528",status:"Error"}}},{title:"\u64CD\u4F5C",key:"action",width:180,fixed:"right",render:(e,t)=>(0,n.jsxs)(b.default,{children:[(0,n.jsx)(o.default,{type:"link",size:"small",onClick:()=>{s(t),l(!0);},children:"\u7F16\u8F91"}),(0,n.jsx)(o.default,{type:"link",size:"small",danger:!0,onClick:()=>y(t),children:"\u5220\u9664"})]})}];return(0,n.jsxs)(i.PageContainer,{children:[(0,n.jsx)(u.ProTable,{headerTitle:"\u90E8\u95E8\u7BA1\u7406",actionRef:c,rowKey:"dept_code",search:!1,toolBarRender:()=>[(0,n.jsxs)(o.default,{type:"primary",onClick:()=>{t(!0);},children:[(0,n.jsx)(r.default,{})," \u65B0\u5EFA"]},"primary")],request:async()=>{let e=await j();if(200===e.code&&e.data){let t=e=>{let a=[];return e.forEach(e=>{a.push(e),e.children&&e.children.length>0&&a.push(...t(e.children));}),a;};return{data:t(e.data),success:!0,total:t(e.data).length};}return{data:[],success:!1,total:0};},columns:_,pagination:!1}),(0,n.jsx)(P,{visible:e,onCancel:()=>t(!1),onSubmit:f,title:"\u65B0\u5EFA\u90E8\u95E8"}),d&&(0,n.jsx)(P,{visible:a,onCancel:()=>{l(!1),s(null);},onSubmit:m,title:"\u7F16\u8F91\u90E8\u95E8",initialValues:d})]});};}}]);
//# sourceMappingURL=035e71d5-async.5cbabbca.js.map